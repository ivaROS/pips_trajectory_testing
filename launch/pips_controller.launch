<launch>
<arg name="driver_decimation" default="false"/>

<arg name="rgb_image" default="/camera/rgb/image_raw" if="$(arg driver_decimation)"/>
<arg name="depth_image" default="/camera/depth/image_raw" if="$(arg driver_decimation)"/>
<arg name="depth_info" default="/camera/depth/camera_info" if="$(arg driver_decimation)"/>
  
<arg name="rgb_image" default="/camera/rgb/image_raw" unless="$(arg driver_decimation)"/>
<arg name="depth_image" default="/camera/decimated/depth_image" unless="$(arg driver_decimation)"/>
<arg name="depth_info" default="/camera/decimated/depth_info" unless="$(arg driver_decimation)"/>

<arg name="camera" default="camera"/>

<arg name="depth_res" default="8"/>
<arg name="parfor" default="true"/>

<arg name="nodelet" default="true"/>

<!-- options:
  2: VGA    640x480
  5: QVGA   320x240
  8: QQVGA  160x120
-->

<!--If driver decimation enabled, set depth camera resolution to lowest-->
<group if="$(arg driver_decimation)">

  <param name="/$(arg camera)/driver/depth_mode" value="$(arg depth_res)" />
  <node name="dynparam_set_depth_resolution" pkg="dynamic_reconfigure" type="dynparam" args="set /$(arg camera)/driver depth_mode $(arg depth_res)"/> 
</group>

<group unless="$(arg driver_decimation)">

</group>

<param name="enable_parallel_loop" value="$(arg parfor)"/>



<node name="pips_controller_nodelet" pkg="nodelet" type="nodelet" args="load pips_trajectory_testing/pips_trajectory_controller_nodelet $(arg camera)/camera_nodelet_manager" output="screen" if="$(arg nodelet)" >
    <remap from="/pips_controller_nodelet/rgb/image_raw" to="$(arg rgb_image)" />
    <remap from="/pips_controller_nodelet/depth_image_raw" to="$(arg depth_image)" />
    <remap from="/pips_controller_nodelet/depth_camera_info" to="$(arg depth_info)" />
</node>

<node name="pips_controller_node" pkg="pips_trajectory_testing" type="pips_trajectory_controller_main" args="" output="screen" unless="$(arg nodelet)" >
    <remap from="depth_image_raw" to="$(arg depth_image)" />
    <remap from="depth_camera_info" to="$(arg depth_info)" />
</node>


  
</launch>
